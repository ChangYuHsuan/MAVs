

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head><div class = "head"> </div>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tips and tricks &mdash; Artelys Knitro 10.3 User&#39;s Manual</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/Artelys_theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Artelys Knitro 10.3 User&#39;s Manual" href="../index.html"/>
        <link rel="up" title="User guide" href="../2_userGuide.html"/>
        <link rel="next" title="Bibliography" href="bibliography.html"/>
        <link rel="prev" title="Special problem classes" href="specialProblems.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Artelys Knitro User's Manual
          

          
          </a>

          
            
            
              <div class="version">
                10.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../1_introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../2_userGuide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gettingStarted.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="knitroOptions.html">Setting options</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives.html">Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="multistart.html">Multistart</a></li>
<li class="toctree-l2"><a class="reference internal" href="minlp.html">Mixed-integer nonlinear programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="complementarity.html">Complementarity constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="ktrlsq.html">Nonlinear Least-Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithms.html">Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="feasibility.html">Feasibility and infeasibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelism.html">Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="tuner.html">The Knitro-Tuner</a></li>
<li class="toctree-l2"><a class="reference internal" href="termination.html">Termination criteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="obtainingInformation.html">Obtaining information</a></li>
<li class="toctree-l2"><a class="reference internal" href="callbacks.html">Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="otherProgInterfaces.html">Other programmatic interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="specialProblems.html">Special problem classes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tips and tricks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#automatic-differentiation-ad">Automatic Differentiation (AD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#why-is-automatic-differentiation-important">Why is Automatic Differentiation important?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#option-tuning-for-efficiency">Option tuning for efficiency</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-bounds-efficiently">Setting bounds efficiently</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#why-is-knitro-not-honoring-my-bound-constraints">Why is Knitro not honoring my bound constraints?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#do-i-need-to-specify-a-constraint-with-and-if-i-already-specified-it-with-the-bounds-parameters-and">Do I need to specify a constraint with <span class="math">c^U</span>, <span class="math">c^L</span>, and <span class="math">c</span> if I already specified it with the bounds parameters <span class="math">b^U</span> and <span class="math">b^L</span> ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#do-i-need-to-initialize-all-of-the-bounds-parameters-what-if-a-variable-is-unbounded">Do I need to initialize all of the bounds parameters? What if a variable is unbounded?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#do-i-need-to-initialize-all-of-the-constraint-parameters-and-what-if-a-constraint-is-unbounded">Do I need to initialize all of the constraint parameters <span class="math">c^U</span> and <span class="math">c^L</span>? What if a constraint is unbounded?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#memory-issues">Memory issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reproducibility-issues-across-platform-computer">Reproducibility issues across platform/computer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3_referenceManual.html">Reference manual</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Artelys Knitro User's Manual</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../2_userGuide.html">User guide</a> &raquo;</li>
      
    <li>Tips and tricks</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="sec-tips-and-tricks"></span><div class="section" id="tips-and-tricks">
<span id="index-0"></span><h1>Tips and tricks</h1>
<p>This last chapter contains some rules of the thumb to improve efficiency, solve memory issues
and other frequent problems.</p>
<div class="section" id="automatic-differentiation-ad">
<span id="index-1"></span><h2>Automatic Differentiation (AD)</h2>
<div class="section" id="why-is-automatic-differentiation-important">
<h3>Why is Automatic Differentiation important?</h3>
<p>Nonlinear optimization software relies on accurate and efficient derivative computations for faster solutions and improved robustness.</p>
<p>Knitro in particular has the ability to utilize second derivative (Hessian matrix) information for faster convergence.
Computing partial derivatives and coding them manually in a programming language can be time consuming and error prone
(Knitro does provide a function to check first derivatives against finite differences).</p>
<p>Automatic Differentiation (AD) is a modern technique which automatically and efficiently computes the exact derivatives so
that the user is freed from dealing with this issue.</p>
<p>Most modeling languages provide automatic differentiation.</p>
</div>
</div>
<div class="section" id="option-tuning-for-efficiency">
<span id="index-2"></span><h2>Option tuning for efficiency</h2>
<ul class="simple">
<li>If you are unsure how to set non-default options, or which user options
to play with, simply running your model with the setting <a class="reference internal" href="../3_referenceManual/userOptions.html#tuner" title="tuner"><code class="xref c c-type docutils literal"><span class="pre">tuner</span></code></a> =1
will cause the Knitro-Tuner to run many instances of your model with a variety
of option settings, and report some statistics and recommendations on what
non-default option settings may improve performance on your model.  Often
significant performance improvements may be made by choosing non-default
option settings.  See <a class="reference internal" href="tuner.html#sec-tuner"><span class="std std-ref">The Knitro-Tuner</span></a> for more details.</li>
<li>The most important user option is the choice of which continuous
nonlinear optimization algorithm to use, which is specified by the
<a class="reference internal" href="../3_referenceManual/userOptions.html#algorithm" title="algorithm"><code class="xref c c-type docutils literal"><span class="pre">algorithm</span></code></a> option.  Please try all four options as it is often difficult to
predict which one will work best, or try using the <em>multi</em> option
(<code class="xref c c-type docutils literal"><span class="pre">algorithm=5</span></code>).  In particular the Active Set
algorithms may often work best for small problems, problems whose only constraints
are simple bounds on the variables, or linear programs.  The interior-point
algorithms are generally preferable for large-scale problems.</li>
<li>Perhaps the second most important user option setting is the <a class="reference internal" href="../3_referenceManual/userOptions.html#hessopt" title="hessopt"><code class="xref c c-type docutils literal"><span class="pre">hessopt</span></code></a>
user option that specifies which Hessian (or Hessian approximation) technique
to use.  If you (or the modeling language) are not providing the  exact
Hessian to Knitro, then you should experiment with different values here.</li>
<li>One of the most important user options for the interior-point
algorithms is the <a class="reference internal" href="../3_referenceManual/userOptions.html#bar_murule" title="bar_murule"><code class="xref c c-type docutils literal"><span class="pre">bar_murule</span></code></a> option, which controls the handling
of the barrier parameter.  It is recommended to experiment
with different values for this user option if you are using one of the
interior-point solvers in Knitro.</li>
<li>If you are using the Interior/Direct algorithm
and it seems to be taking a large number of conjugate gradient (CG) steps
(as evidenced by a non-zero value under the  CGits output column header
on many iterations), then you should try a small value for the
<a class="reference internal" href="../3_referenceManual/userOptions.html#bar_directinterval" title="bar_directinterval"><code class="xref c c-type docutils literal"><span class="pre">bar_directinterval</span></code></a> user option (e.g., 0-2).  This option will try
to prevent Knitro from taking an excessive number of CG steps.  Additionally,
if there are solver iterations where Knitro slows down because it is taking a very
large number of CG iterations, you can try enforcing a maximum limit on the
number of CG iterations per algorithm iteration using the <a class="reference internal" href="../3_referenceManual/userOptions.html#cg_maxit" title="cg_maxit"><code class="xref c c-type docutils literal"><span class="pre">cg_maxit</span></code></a>
user option.</li>
<li>The <a class="reference internal" href="../3_referenceManual/userOptions.html#linsolver" title="linsolver"><code class="xref c c-type docutils literal"><span class="pre">linsolver</span></code></a> option can make a big difference in performance
for some problems. For small problems (particularly small problems with dense
Jacobian and Hessian matrices), it is recommended to try the <em>qr</em> setting,
while for large problems, it is recommended to try the <em>hybrid</em>, <em>ma27</em>, <em>ma57</em>
and <em>mklpardiso</em> settings to see which is fastest.
When using either the  <em>hybrid</em>, <em>qr</em>, <em>ma57</em>, or <em>mklpardiso</em> setting for the
<a class="reference internal" href="../3_referenceManual/userOptions.html#linsolver" title="linsolver"><code class="xref c c-type docutils literal"><span class="pre">linsolver</span></code></a>
option it is <em>highly</em> recommended to use the Intel MKL BLAS
(<a class="reference internal" href="../3_referenceManual/userOptions.html#blasoption" title="blasoption"><code class="xref c c-type docutils literal"><span class="pre">blasoption</span></code></a> = 1)
provided with Knitro or some other optimized BLAS as this can result in
significant speedups compared to the internal Knitro BLAS (<a class="reference internal" href="../3_referenceManual/userOptions.html#blasoption" title="blasoption"><code class="xref c c-type docutils literal"><span class="pre">blasoption</span></code></a> = 0).</li>
<li>When solving mixed integer problems (MIPs), if Knitro is struggling to
find an integer feasible point, then you should try different values for the
<a class="reference internal" href="../3_referenceManual/userOptions.html#mip_heuristic" title="mip_heuristic"><code class="xref c c-type docutils literal"><span class="pre">mip_heuristic</span></code></a> option, which will try to find an integer feasible point
before beginning the branch and bound process.  Other important MIP
options that can significantly impact the performance of Knitro are the
<a class="reference internal" href="../3_referenceManual/userOptions.html#mip_method" title="mip_method"><code class="xref c c-type docutils literal"><span class="pre">mip_method</span></code></a>,  <a class="reference internal" href="../3_referenceManual/userOptions.html#mip_branchrule" title="mip_branchrule"><code class="xref c c-type docutils literal"><span class="pre">mip_branchrule</span></code></a>,
and  <a class="reference internal" href="../3_referenceManual/userOptions.html#mip_selectrule" title="mip_selectrule"><code class="xref c c-type docutils literal"><span class="pre">mip_selectrule</span></code></a> user options,
as well as the <a class="reference internal" href="../3_referenceManual/userOptions.html#mip_nodealg" title="mip_nodealg"><code class="xref c c-type docutils literal"><span class="pre">mip_nodealg</span></code></a> option which will determine the Knitro
algorithm to use to solve the nonlinear, continuous subproblems generated
during the branch and bound process.</li>
</ul>
</div>
<div class="section" id="setting-bounds-efficiently">
<span id="index-3"></span><h2>Setting bounds efficiently</h2>
<div class="section" id="why-is-knitro-not-honoring-my-bound-constraints">
<h3>Why is Knitro not honoring my bound constraints?</h3>
<p>By default Knitro does not enforce that simple bounds on the variables (<span class="math">x</span>)
are satisfied throughout the optimization process. Rather, satisfaction of these bounds is only enforced at the solution.</p>
<p>In some applications, however, the user may want to enforce that the initial point and all intermediate iterates satisfy the
bounds <span class="math">b^L \leq x \leq b^U</span>.
This can be enforced by setting <a class="reference internal" href="../3_referenceManual/userOptions.html#KTR_PARAM_HONORBNDS" title="KTR_PARAM_HONORBNDS"><code class="xref c c-type docutils literal"><span class="pre">KTR_PARAM_HONORBNDS</span></code></a> to 1.</p>
<p>Please note, the honor bounds option pertains only to the simple bounds defined with vectors <span class="math">b^U</span> and <span class="math">b^L</span> for <span class="math">x</span>,
not to the general equality and inequality constraints defined with the vectors <span class="math">c^U</span>, <span class="math">c^L</span>, and <span class="math">c</span>.</p>
</div>
<div class="section" id="do-i-need-to-specify-a-constraint-with-and-if-i-already-specified-it-with-the-bounds-parameters-and">
<h3>Do I need to specify a constraint with <span class="math">c^U</span>, <span class="math">c^L</span>, and <span class="math">c</span> if I already specified it with the bounds parameters <span class="math">b^U</span> and <span class="math">b^L</span> ?</h3>
<p>No, if you have specified a constraint with the bounds parameters then you should not specify it with the general constraints.</p>
<p>For example, <span class="math">x_0 \leq 2</span> is best modeled by setting <span class="math">b^L_0 =-</span> <code class="docutils literal"><span class="pre">KTR_INFBOUND</span></code> and <span class="math">b^U_0 = 2</span>.</p>
<p>Duplicate specification of a constraint can make the problem more difficult to solve.</p>
</div>
<div class="section" id="do-i-need-to-initialize-all-of-the-bounds-parameters-what-if-a-variable-is-unbounded">
<h3>Do I need to initialize all of the bounds parameters? What if a variable is unbounded?</h3>
<p>If every variable is unbounded from below (or above), then you can pass a NULL pointer for <span class="math">b^L</span> (or <span class="math">b^U</span>),
and Knitro will interpret this to mean unbounded.</p>
<p>If at least one variable is bounded from below (or above), then you must initialize all elements of <span class="math">b^L</span> (or <span class="math">b^U</span>).</p>
<p>Use Knitro&#8217;s value for infinity, <code class="docutils literal"><span class="pre">KTR_INFBOUND</span></code> to denote unbounded.</p>
<p>If the bound is larger in magnitude than <code class="docutils literal"><span class="pre">KTR_INFBOUND</span></code>, then you must rescale the problem. See  <code class="docutils literal"><span class="pre">include/knitro.h</span></code> for the definition of <code class="docutils literal"><span class="pre">KTR_INFBOUND</span></code>.</p>
</div>
<div class="section" id="do-i-need-to-initialize-all-of-the-constraint-parameters-and-what-if-a-constraint-is-unbounded">
<h3>Do I need to initialize all of the constraint parameters <span class="math">c^U</span> and <span class="math">c^L</span>? What if a constraint is unbounded?</h3>
<p>You must initialize all elements of <span class="math">c^U</span> and <span class="math">c^L</span>.</p>
<p>If a constraint is unbounded use Knitro&#8217;s value for infinity, <code class="docutils literal"><span class="pre">KTR_INFBOUND</span></code>.</p>
<p>If the constraint is larger in magnitude than KTR_INFBOUND, then you must rescale the problem. See  <code class="docutils literal"><span class="pre">include/knitro.h</span></code> for the definition of <code class="docutils literal"><span class="pre">KTR_INFBOUND</span></code>.</p>
</div>
</div>
<div class="section" id="memory-issues">
<span id="index-4"></span><h2>Memory issues</h2>
<p>If you receive a Knitro termination message indicating that there
was not enough memory on your computer to solve the problem, or if your
problem appears to be running very slow because it is using nearly
all of the available memory on your computer system, the following are
some recommendations to try to reduce the amount of memory
used by Knitro.</p>
<ul class="simple">
<li>Experiment with different algorithms. Typically the Interior/Direct
algorithm is chosen by default and uses the most memory.  The
Interior/CG and  Active Set algorithms usually use much less memory.
In particular if the Hessian matrix is large and dense and using most of the
memory, then the  Interior/CG method may offer big savings in memory.
If the constraint Jacobian matrix is large and dense and using most of the memory,
then the  Active Set algorithm may use much less memory on your problem.</li>
<li>If much of the memory usage seems to come from the Hessian matrix,
then you should try different Hessian options via the <a class="reference internal" href="../3_referenceManual/userOptions.html#hessopt" title="hessopt"><code class="xref c c-type docutils literal"><span class="pre">hessopt</span></code></a>
user option. In particular <a class="reference internal" href="../3_referenceManual/userOptions.html#hessopt" title="hessopt"><code class="xref c c-type docutils literal"><span class="pre">hessopt</span></code></a> settings <em>product_findiff</em>,
<em>product</em>, and <em>lbfgs</em> use the least amount of memory.</li>
<li>Try different linear solver options in Knitro via the <a class="reference internal" href="../3_referenceManual/userOptions.html#linsolver" title="linsolver"><code class="xref c c-type docutils literal"><span class="pre">linsolver</span></code></a> user option.
Sometimes even if your problem definition (e.g. Hessian and Jacobian matrix)
can be easily stored in memory, the sparse linear system solvers inside Knitro
may require a lot of extra memory to perform and store matrix factorizations.
If your problem size is relatively small you can try <a class="reference internal" href="../3_referenceManual/userOptions.html#linsolver" title="linsolver"><code class="xref c c-type docutils literal"><span class="pre">linsolver</span></code></a> setting
<em>qr</em>.  For large problems you should try both <em>ma27</em> and <em>ma57</em> settings
as one or the other may use significantly less memory.  In addition, using a smaller
<a class="reference internal" href="../3_referenceManual/userOptions.html#linsolver_pivottol" title="linsolver_pivottol"><code class="xref c c-type docutils literal"><span class="pre">linsolver_pivottol</span></code></a> user option value may reduce the amount of memory needed for the linear solver.</li>
</ul>
</div>
<div class="section" id="reproducibility-issues-across-platform-computer">
<span id="index-5"></span><h2>Reproducibility issues across platform/computer</h2>
<p>If you notice different results accross platforms/computers for the exact same Knitro run (same model, same initial conditions, same options),
it is probably due to one of the following reasons:</p>
<ul class="simple">
<li>Knitro library is built with different compilers on different OS which can cause small numerical differences that propagate.</li>
<li>The Intel MKL library has specializations to optimize performance for particular hardware/CPUs/environments which can also cause numerical differences.</li>
</ul>
<p>To avoid the second issue you may set <a class="reference internal" href="../3_referenceManual/userOptions.html#blasoption" title="blasoption"><code class="xref c c-type docutils literal"><span class="pre">blasoption</span></code></a> = 0.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bibliography.html" class="btn btn-neutral float-right" title="Bibliography" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="specialProblems.html" class="btn btn-neutral" title="Special problem classes" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Artelys.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'10.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>