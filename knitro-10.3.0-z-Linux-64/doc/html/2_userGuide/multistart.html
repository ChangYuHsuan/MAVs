

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head><div class = "head"> </div>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multistart &mdash; Artelys Knitro 10.3 User&#39;s Manual</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/Artelys_theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Artelys Knitro 10.3 User&#39;s Manual" href="../index.html"/>
        <link rel="up" title="User guide" href="../2_userGuide.html"/>
        <link rel="next" title="Mixed-integer nonlinear programming" href="minlp.html"/>
        <link rel="prev" title="Derivatives" href="derivatives.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Artelys Knitro User's Manual
          

          
          </a>

          
            
            
              <div class="version">
                10.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../1_introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../2_userGuide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gettingStarted.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="knitroOptions.html">Setting options</a></li>
<li class="toctree-l2"><a class="reference internal" href="derivatives.html">Derivatives</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Multistart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#multistart-algorithm">Multistart algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parallel-multistart">Parallel multistart</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multistart-output">Multistart output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multistart-options">Multistart options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multistart-callbacks">Multistart callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ampl-example">AMPL example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#matlab-example">MATLAB example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#c-example">C example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#object-oriented-example">Object-oriented example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="minlp.html">Mixed-integer nonlinear programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="complementarity.html">Complementarity constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="ktrlsq.html">Nonlinear Least-Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithms.html">Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="feasibility.html">Feasibility and infeasibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelism.html">Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="tuner.html">The Knitro-Tuner</a></li>
<li class="toctree-l2"><a class="reference internal" href="termination.html">Termination criteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="obtainingInformation.html">Obtaining information</a></li>
<li class="toctree-l2"><a class="reference internal" href="callbacks.html">Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="otherProgInterfaces.html">Other programmatic interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="specialProblems.html">Special problem classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="tips.html">Tips and tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3_referenceManual.html">Reference manual</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Artelys Knitro User's Manual</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../2_userGuide.html">User guide</a> &raquo;</li>
      
    <li>Multistart</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multistart">
<span id="sec-multistart"></span><h1>Multistart</h1>
<p id="index-0">Nonlinear optimization problems are often nonconvex due to the
objective function, constraint functions, or both.  When this is true, there
may be many points that satisfy the local optimality conditions.
Default Knitro behavior is to return the
first locally optimal point found.  Knitro offers a simple
<em>multi-start</em> feature that searches for a better optimal point by
restarting Knitro from different initial points.  The feature is
enabled by setting <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_enable" title="ms_enable"><code class="xref c c-type docutils literal"><span class="pre">ms_enable</span></code></a> = 1.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In many cases the user would like to obtain the global optimum
to the optimization problem; that is, the local optimum with
the very best objective function
value.  Knitro cannot guarantee that multi-start will find the global
optimum.  In general, the global optimum can only be found with special
knowledge of the objective and constraint functions; for example, the functions
may need to be bounded by other piece-wise convex functions.
Knitro executes with very little information about functional form.
Although no guarantee can be made, the probability of finding a better local
solution improves if more start points are tried.</p>
</div>
<div class="section" id="multistart-algorithm">
<h2>Multistart algorithm</h2>
<p>The multi-start procedure generates new start points by randomly selecting
components of <em>x</em> that satisfy lower and upper bounds on the variables.
Knitro finds a local optimum from each start point using the same
problem definition and user options.
The final solution returned from <a class="reference internal" href="../3_referenceManual/callableLibrary/API.html#KTR_solve" title="KTR_solve"><code class="xref c c-func docutils literal"><span class="pre">KTR_solve()</span></code></a> is the local optimum
with the best objective function value if any local optima have been found.
If no local optimum has been found, Knitro will return the best
feasible solution estimate it found.  If no feasible solution estimate has
been found, Knitro will return the least infeasible point.</p>
</div>
<div class="section" id="parallel-multistart">
<h2>Parallel multistart</h2>
<p>The multistart procedure can run in parallel on shared memory
multi-processor machines by setting <a class="reference internal" href="../3_referenceManual/userOptions.html#par_numthreads" title="par_numthreads"><code class="xref c c-type docutils literal"><span class="pre">par_numthreads</span></code></a> greater
than 1.  See <a class="reference internal" href="parallelism.html#sec-parallelism"><span class="std std-ref">Parallelism</span></a> for more details on controlling
parallel performance in Knitro.</p>
<p>When the multistart procedure is run in parallel, Knitro
will produce the same sequence of initial points and
solves that you see when running multistart sequentially
(though, perhaps, not in the same order).</p>
<p>Therefore, as long as you run multistart to completion (<a class="reference internal" href="../3_referenceManual/userOptions.html#ms_terminate" title="ms_terminate"><code class="xref c c-type docutils literal"><span class="pre">ms_terminate</span></code></a> =0)
and use the deterministic option (<a class="reference internal" href="../3_referenceManual/userOptions.html#ms_deterministic" title="ms_deterministic"><code class="xref c c-type docutils literal"><span class="pre">ms_deterministic</span></code></a> =1),
you should visit
the same initial points encountered when running multistart sequentially,
and get the same final solution. By default <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_terminate" title="ms_terminate"><code class="xref c c-type docutils literal"><span class="pre">ms_terminate</span></code></a> =0
and <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_deterministic" title="ms_deterministic"><code class="xref c c-type docutils literal"><span class="pre">ms_deterministic</span></code></a> =1 so that the parallel multistart produces
the same solution as the sequential multistart.</p>
<p>However, if <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_deterministic" title="ms_deterministic"><code class="xref c c-type docutils literal"><span class="pre">ms_deterministic</span></code></a> =0, or <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_terminate" title="ms_terminate"><code class="xref c c-type docutils literal"><span class="pre">ms_terminate</span></code></a> &gt;0,
there is no guarantee that the final solution reported by multistart will
be the same when run in parallel compared to the solution when run sequentially,
and even the parallel solution may change when run at different times.</p>
<p>The option <a class="reference internal" href="../3_referenceManual/userOptions.html#par_msnumthreads" title="par_msnumthreads"><code class="xref c c-type docutils literal"><span class="pre">par_msnumthreads</span></code></a> can be used to set the number
of threads used by the multistart procedure. For instance, if
<a class="reference internal" href="../3_referenceManual/userOptions.html#par_numthreads" title="par_numthreads"><code class="xref c c-type docutils literal"><span class="pre">par_numthreads</span></code></a> =16 and <a class="reference internal" href="../3_referenceManual/userOptions.html#par_msnumthreads" title="par_msnumthreads"><code class="xref c c-type docutils literal"><span class="pre">par_msnumthreads</span></code></a> =8,
Knitro will run 8 solves in parallel and each solve will be
allocated 2 threads.</p>
</div>
<div class="section" id="multistart-output">
<h2>Multistart output</h2>
<p>For multistart, you can have output from each local solve written to a file
named <code class="file docutils literal"><span class="pre">knitro_ms_x.log</span></code> where &#8220;x&#8221; is the solve number by setting
the option <code class="xref c c-type docutils literal"><span class="pre">ms_outsub=1</span></code>.</p>
</div>
<div class="section" id="multistart-options">
<h2>Multistart options</h2>
<p>The multi-start option is convenient for conducting a simple search for
a better solution point.  Search time is improved if the variable bounds
are made as tight as possible, confining the search to a region where a
good solution is likely to be found.  The user can restrict the multi-start
search region without altering bounds by using the options
<a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxbndrange" title="ms_maxbndrange"><code class="xref c c-type docutils literal"><span class="pre">ms_maxbndrange</span></code></a> and <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_startptrange" title="ms_startptrange"><code class="xref c c-type docutils literal"><span class="pre">ms_startptrange</span></code></a>. The other multi-start
options are the following.</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_deterministic" title="ms_deterministic"><code class="xref c c-type docutils literal"><span class="pre">ms_deterministic</span></code></a></td>
<td>Control whether to use deterministic multistart</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_enable" title="ms_enable"><code class="xref c c-type docutils literal"><span class="pre">ms_enable</span></code></a></td>
<td>Enable multistart</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxbndrange" title="ms_maxbndrange"><code class="xref c c-type docutils literal"><span class="pre">ms_maxbndrange</span></code></a></td>
<td>Maximum unbounded variable range for multistart</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxsolves" title="ms_maxsolves"><code class="xref c c-type docutils literal"><span class="pre">ms_maxsolves</span></code></a></td>
<td>Maximum Knitro solves for multistart</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxtime_cpu" title="ms_maxtime_cpu"><code class="xref c c-type docutils literal"><span class="pre">ms_maxtime_cpu</span></code></a></td>
<td>Maximum CPU time for multistart, in seconds</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxtime_real" title="ms_maxtime_real"><code class="xref c c-type docutils literal"><span class="pre">ms_maxtime_real</span></code></a></td>
<td>Maximum real time for multistart, in seconds</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_num_to_save" title="ms_num_to_save"><code class="xref c c-type docutils literal"><span class="pre">ms_num_to_save</span></code></a></td>
<td>Feasible points to save from multistart</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_outsub" title="ms_outsub"><code class="xref c c-type docutils literal"><span class="pre">ms_outsub</span></code></a></td>
<td>Can write each solve to a file (parallel only)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_savetol" title="ms_savetol"><code class="xref c c-type docutils literal"><span class="pre">ms_savetol</span></code></a></td>
<td>Tol for feasible points being equal</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_seed" title="ms_seed"><code class="xref c c-type docutils literal"><span class="pre">ms_seed</span></code></a></td>
<td>Initial seed for generating random start points</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_startptrange" title="ms_startptrange"><code class="xref c c-type docutils literal"><span class="pre">ms_startptrange</span></code></a></td>
<td>Maximum variable range for multistart</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../3_referenceManual/userOptions.html#ms_terminate" title="ms_terminate"><code class="xref c c-type docutils literal"><span class="pre">ms_terminate</span></code></a></td>
<td>Termination condition for multistart</td>
</tr>
</tbody>
</table>
<p>The number of start points tried by multi-start is specified with the
option <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxsolves" title="ms_maxsolves"><code class="xref c c-type docutils literal"><span class="pre">ms_maxsolves</span></code></a>.  By default, Knitro will try
<em>min(200, 10*n)</em>, where <em>n</em> is the number of variables in the problem.
Users may override the default by setting <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxsolves" title="ms_maxsolves"><code class="xref c c-type docutils literal"><span class="pre">ms_maxsolves</span></code></a> to
a specific value.</p>
<p>The <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxbndrange" title="ms_maxbndrange"><code class="xref c c-type docutils literal"><span class="pre">ms_maxbndrange</span></code></a> option applies to variables unbounded in at least one direction
(i.e., the upper or lower bound, or both, is infinite)
and keeps new start points within a total range equal to the value of
<a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxbndrange" title="ms_maxbndrange"><code class="xref c c-type docutils literal"><span class="pre">ms_maxbndrange</span></code></a>.
The <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_startptrange" title="ms_startptrange"><code class="xref c c-type docutils literal"><span class="pre">ms_startptrange</span></code></a> option applies to all variables and keeps new start points within
a total range equal to the value of <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_startptrange" title="ms_startptrange"><code class="xref c c-type docutils literal"><span class="pre">ms_startptrange</span></code></a>, overruling
<a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxbndrange" title="ms_maxbndrange"><code class="xref c c-type docutils literal"><span class="pre">ms_maxbndrange</span></code></a> if it is a tighter bound.
In general, use <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_startptrange" title="ms_startptrange"><code class="xref c c-type docutils literal"><span class="pre">ms_startptrange</span></code></a> to limit the multi-start search
only if the initial start point supplied by the user is known to be the center
of a desired search area.  Use <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxbndrange" title="ms_maxbndrange"><code class="xref c c-type docutils literal"><span class="pre">ms_maxbndrange</span></code></a> as a surrogate bound
to limit the multi-start search when a variable is unbounded.</p>
<p>The <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_num_to_save" title="ms_num_to_save"><code class="xref c c-type docutils literal"><span class="pre">ms_num_to_save</span></code></a> option
allows a specific number of distinct feasible points to be saved in a file named
<code class="file docutils literal"><span class="pre">knitro_mspoints.log</span></code>.  Each point results from a Knitro solve
from a different starting point, and must satisfy the absolute and relative
feasibility tolerances.  Different start points may return the same feasible
point, and the file contains only distinct points.  The option
<a class="reference internal" href="../3_referenceManual/userOptions.html#ms_savetol" title="ms_savetol"><code class="xref c c-type docutils literal"><span class="pre">ms_savetol</span></code></a> determines that two points are distinct if their
objectives or any solution components (including Lagrange multipliers)
are separated by more than the value of
<a class="reference internal" href="../3_referenceManual/userOptions.html#ms_savetol" title="ms_savetol"><code class="xref c c-type docutils literal"><span class="pre">ms_savetol</span></code></a> using a relative tolerance test.
More specifically, two values <em>x</em> and <em>y</em> are considered distinct if:</p>
<div class="math">
<p><span class="math">|x-y| \geq  \max(1,|x|,|y|) * \mbox{ms\_savetol}.</span></p>
</div><p>The file stores points in order from best objective to worst.  If objectives
are the same (as defined by <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_savetol" title="ms_savetol"><code class="xref c c-type docutils literal"><span class="pre">ms_savetol</span></code></a>), then points are
ordered from smallest feasibility error to largest.  The file can be read
manually, but conforms to a fixed property/value format for machine reading.</p>
<p>Instead of using multi-start to search for a global solution, a user may want to
use multi-start as a mechanism for finding any locally optimal or feasible solution
estimate of a nonconvex problem and terminate as soon as one such point is found.
The <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_terminate" title="ms_terminate"><code class="xref c c-type docutils literal"><span class="pre">ms_terminate</span></code></a> option, provides the user more control over when to terminate
the multi-start procedure.</p>
<p>If <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_terminate" title="ms_terminate"><code class="xref c c-type docutils literal"><span class="pre">ms_terminate</span></code></a> = <em>optimal</em> the multi-start procedure will stop as soon as
the first locally optimal solution is found or after <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxsolves" title="ms_maxsolves"><code class="xref c c-type docutils literal"><span class="pre">ms_maxsolves</span></code></a>
&#8211; whichever comes first.  If <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_terminate" title="ms_terminate"><code class="xref c c-type docutils literal"><span class="pre">ms_terminate</span></code></a> = <em>feasible</em> the multi-start
procedure will instead stop as soon as the first feasible solution estimate is found
or after <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxsolves" title="ms_maxsolves"><code class="xref c c-type docutils literal"><span class="pre">ms_maxsolves</span></code></a> &#8211; whichever comes first.  If
<a class="reference internal" href="../3_referenceManual/userOptions.html#ms_terminate" title="ms_terminate"><code class="xref c c-type docutils literal"><span class="pre">ms_terminate</span></code></a> = <em>maxsolves</em>, it will only terminate after <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_maxsolves" title="ms_maxsolves"><code class="xref c c-type docutils literal"><span class="pre">ms_maxsolves</span></code></a>.</p>
<p>The option <a class="reference internal" href="../3_referenceManual/userOptions.html#ms_seed" title="ms_seed"><code class="xref c c-type docutils literal"><span class="pre">ms_seed</span></code></a> can be used to change the seed used to generate the random
initial points for multistart.</p>
</div>
<div class="section" id="multistart-callbacks">
<h2>Multistart callbacks</h2>
<p>The multistart procedure provides two callback utilities for the callable library API.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="kt">int</span>  <span class="n">KNITRO_API</span> <span class="nf">KTR_set_ms_process_callback</span> <span class="p">(</span><span class="n">KTR_context_ptr</span>       <span class="n">kc</span><span class="p">,</span>
                                             <span class="n">KTR_callback</span> <span class="o">*</span> <span class="k">const</span>  <span class="n">fnPtr</span><span class="p">);</span>

<span class="kt">int</span>  <span class="n">KNITRO_API</span> <span class="nf">KTR_set_ms_initpt_callback</span> <span class="p">(</span><span class="n">KTR_context_ptr</span>                 <span class="n">kc</span><span class="p">,</span>
                                            <span class="n">KTR_ms_initpt_callback</span> <span class="o">*</span> <span class="k">const</span>  <span class="n">fnPtr</span><span class="p">);</span>
</pre></div>
</div>
<p>The first callback can be used to perform some user task after each multistart solve
and is set by calling <a class="reference internal" href="../3_referenceManual/callableLibrary/API.html#KTR_set_ms_process_callback" title="KTR_set_ms_process_callback"><code class="xref c c-func docutils literal"><span class="pre">KTR_set_ms_process_callback()</span></code></a>.  You can use the second
callback to specify your own initial points for multistart instead of using the
randomly generated Knitro initial points.  This callback function can be set through the
function <a class="reference internal" href="../3_referenceManual/callableLibrary/API.html#KTR_set_ms_initpt_callback" title="KTR_set_ms_initpt_callback"><code class="xref c c-func docutils literal"><span class="pre">KTR_set_ms_initpt_callback()</span></code></a>.</p>
<p>See the <a class="reference internal" href="../3_referenceManual/callableLibrary/API.html#sec-api"><span class="std std-ref">Knitro API</span></a> section in the Reference Manual for details on setting
these callback functions and the prototypes for these callback functions.</p>
<p>In the object-oriented interface, the following functions are used to set the callbacks:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">KTRProblem</span><span class="o">::</span><span class="n">setMSProcessCallback</span><span class="p">(</span><span class="n">KTRMSProcessCallback</span><span class="o">*</span> <span class="n">MSProcessCallback</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">KTRProblem</span><span class="o">::</span><span class="n">setMSInitPtCallback</span><span class="p">(</span><span class="n">KTRMSInitptCallback</span><span class="o">*</span> <span class="n">MSInitPtCallback</span><span class="p">);</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="../3_referenceManual/ooInterfaceReference.html#sec-oointerfacereference"><span class="std std-ref">Object-oriented interface reference</span></a> section for details on setting these callback
functions in the object-oriented interface.</p>
</div>
<div class="section" id="ampl-example">
<h2>AMPL example</h2>
<p>Let us consider again our AMPL example from Section <a class="reference internal" href="gettingStarted/startAmpl.html#getstartampl"><span class="std std-ref">Getting started with AMPL</span></a>
and run it with a different set of options:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>ampl: reset;
ampl: option solver knitroampl;
ampl: option knitro_options &quot;ms_enable=1 ms_num_to_save=5 ms_savetol=0.01&quot;;
ampl: model testproblem.mod;
ampl: solve;
</pre></div>
</td></tr></table></div>
<p>The Knitro log printed on screen changes to reflect the results of the
many solver runs that were made during the multistart procedure, and the
very end of this log reads:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Multistart</span> <span class="n">stopping</span><span class="p">,</span> <span class="n">reached</span> <span class="n">ms_maxsolves</span> <span class="n">limit</span><span class="o">.</span>

<span class="n">MULTISTART</span><span class="p">:</span> <span class="n">Best</span> <span class="n">locally</span> <span class="n">optimal</span> <span class="n">point</span> <span class="ow">is</span> <span class="n">returned</span><span class="o">.</span>
<span class="n">EXIT</span><span class="p">:</span> <span class="n">Locally</span> <span class="n">optimal</span> <span class="n">solution</span> <span class="n">found</span><span class="o">.</span>

<span class="n">Final</span> <span class="n">Statistics</span>
<span class="o">----------------</span>
<span class="n">Final</span> <span class="n">objective</span> <span class="n">value</span>               <span class="o">=</span>   <span class="mf">9.35999999745429e+02</span>
<span class="n">Final</span> <span class="n">feasibility</span> <span class="n">error</span> <span class="p">(</span><span class="nb">abs</span> <span class="o">/</span> <span class="n">rel</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">1.44e-07</span> <span class="o">/</span> <span class="mf">3.83e-10</span>
<span class="n">Final</span> <span class="n">optimality</span> <span class="n">error</span>  <span class="p">(</span><span class="nb">abs</span> <span class="o">/</span> <span class="n">rel</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">6.48e-07</span> <span class="o">/</span> <span class="mf">4.28e-08</span>
<span class="c1"># of iterations                     =        415</span>
<span class="c1"># of CG iterations                  =         90</span>
<span class="c1"># of function evaluations           =        545</span>
<span class="c1"># of gradient evaluations           =        475</span>
<span class="c1"># of Hessian evaluations            =        422</span>
<span class="n">Total</span> <span class="n">program</span> <span class="n">time</span> <span class="p">(</span><span class="n">secs</span><span class="p">)</span>           <span class="o">=</span>       <span class="mf">0.02660</span> <span class="p">(</span>     <span class="mf">0.027</span> <span class="n">CPU</span> <span class="n">time</span><span class="p">)</span>

<span class="o">===============================================================================</span>

<span class="n">Knitro</span> <span class="mf">10.0</span><span class="o">.</span><span class="mi">0</span><span class="p">:</span> <span class="n">Locally</span> <span class="n">optimal</span> <span class="ow">or</span> <span class="n">satisfactory</span> <span class="n">solution</span><span class="o">.</span>
<span class="n">objective</span> <span class="mf">935.9999997</span><span class="p">;</span> <span class="n">feasibility</span> <span class="n">error</span> <span class="mf">1.44e-07</span>
<span class="mi">415</span> <span class="n">iterations</span><span class="p">;</span> <span class="mi">545</span> <span class="n">function</span> <span class="n">evaluations</span>
</pre></div>
</div>
<p>which shows that many more functions calls were made than without
multistart. A file <code class="file docutils literal"><span class="pre">knitro_mspoints.txt</span></code> was also created,
whose content reads:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>// Knitro 10.0.0 Multi-start Repository for feasible points.
// Each point contains information about the problem and the point.
// Points are sorted by objective value, from best to worst.


// Next feasible point.
numVars = 3
numCons = 2
objGoal = MINIMIZE
obj =   9.3600000342420878e+02
knitroStatus = 0
localSolveNumber = 1
feasibleErrorAbsolute =   0.00e+00
feasibleErrorRelative =   0.00e+00
optimalityErrorAbsolute =   2.25e-07
optimalityErrorRelative =   1.41e-08
x[0] =   2.0511214409048425e-07
x[1] =   4.1077619358921463e-08
x[2] =   7.9999996834308824e+00
lambda[0] =  -4.5247620510168322e-08
lambda[1] =   2.2857143915699769e+00
lambda[2] =  -1.0285715141992103e+01
lambda[3] =  -3.2000001143071813e+01
lambda[4] =  -2.1985040913238130e-07

// Next feasible point.
numVars = 3
numCons = 2
objGoal = MINIMIZE
obj =   9.5100000269458542e+02
knitroStatus = 0
localSolveNumber = 2
feasibleErrorAbsolute =   0.00e+00
feasibleErrorRelative =   0.00e+00
optimalityErrorAbsolute =   3.67e-07
optimalityErrorRelative =   2.62e-08
x[0] =   6.9999996377946481e+00
x[1] =   7.4479065893720198e-08
x[2] =   2.6499084231411754e-07
lambda[0] =  -6.3891336872934633e-08
lambda[1] =   1.7500001368019027e+00
lambda[2] =  -2.1791026695882249e-07
lambda[3] =  -1.7500002055167382e+01
lambda[4] =  -5.2500010586300956e+00
</pre></div>
</div>
<p>In addition to the known solution with value 936
that we had already found with a single solver run,
we discover another local minimum with value 951 that
we had never seen before. In this case, the new
solution is not as good as the first one, but sometimes
running the multistart algorithm significantly improves
the objective function value with respect to single-run
optimization.</p>
</div>
<div class="section" id="matlab-example">
<h2>MATLAB example</h2>
<p>In order to run the multistart algorithm in MATLAB, we must pass
the relevant set of options to Knitro via the Knitro options file.
Let us create a simple text file named <code class="file docutils literal"><span class="pre">knitro.opt</span></code> with the
following content:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ms_enable</span> <span class="mi">1</span>
<span class="n">ms_num_to_save</span> <span class="mi">5</span>
<span class="n">ms_savetol</span> <span class="mf">0.01</span>
<span class="n">hessopt</span> <span class="mi">2</span>
</pre></div>
</div>
<p>(the last line <em>hessopt 2</em> is necessary to remind Knitro to use approximate
second derivatives, since we are not providing the exact hessian).
Then let us run our MATLAB example from Section <a class="reference internal" href="derivatives.html#matlabexamplefirstder"><span class="std std-ref">MATLAB example</span></a>
again, where the call to <em>knitromatlab</em> has been replaced with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">knitromatlab</span><span class="p">(</span><span class="nd">@obj</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Aeq</span><span class="p">,</span> <span class="n">beq</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="nd">@nlcon</span><span class="p">,</span> <span class="p">[],</span> <span class="n">options</span><span class="p">,</span> <span class="s1">&#39;knitro.opt&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>and where the <code class="file docutils literal"><span class="pre">knitro.opt</span></code> file was placed in the current directory so that
MATLAB can find it. The Knitro log looks simlar to what we observed with AMPL.</p>
</div>
<div class="section" id="c-example">
<h2>C example</h2>
<p>The C example can also be easily modified to enable
multistart by adding the following lines before the
call to <a class="reference internal" href="../3_referenceManual/callableLibrary/API.html#KTR_solve" title="KTR_solve"><code class="xref c c-func docutils literal"><span class="pre">KTR_solve()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">multistart</span>
<span class="k">if</span> <span class="p">(</span><span class="n">KTR_set_int_param_by_name</span> <span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="s2">&quot;ms_enable&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">exit</span><span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">KTR_set_int_param_by_name</span> <span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="s2">&quot;ms_num_to_save&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">exit</span><span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">KTR_set_double_param_by_name</span> <span class="p">(</span><span class="n">kc</span><span class="p">,</span> <span class="s2">&quot;ms_savetol&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">exit</span><span class="p">(</span> <span class="o">-</span><span class="mi">1</span> <span class="p">);</span>
</pre></div>
</div>
<p>Again, running this example we get a Knitro log that looks similar to
what we observed with AMPL.</p>
</div>
<div class="section" id="object-oriented-example">
<h2>Object-oriented example</h2>
<p>The object-oriented example can be modified to enable
multistart by adding the following lines before the
call to <code class="xref c c-func docutils literal"><span class="pre">solver.solve()</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">multistart</span>
<span class="n">solver</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;ms_enable&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">solver</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;ms_num_to_save&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="n">solver</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;ms_savetol&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">);</span>
</pre></div>
</div>
<p>Again, running this example we get a Knitro log that looks similar to the trace
obtained with AMPL.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="minlp.html" class="btn btn-neutral float-right" title="Mixed-integer nonlinear programming" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="derivatives.html" class="btn btn-neutral" title="Derivatives" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Artelys.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'10.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>